<%= javascript_include_tag 'bootstrap-popover', 'bootstrap-tooltip' %>
<style>
  .popover{
    top: 457.5px!important;
  }
</style>

<script type="text/javascript">
$(function () {
  var options = {
    textColour: '#08C',
    textHeight: 40,
    depth: 0.99,
    stretchX: 6,
    minSpeed: 0.002,
    maxSpeed: 0.005,
    initial: [0.6,-0.3],
    weight: true
  };
  window.onload = function() {
    try {
      TagCanvas.Start('myCanvas', '', options);
    } catch(e) {
      // something went wrong, hide the canvas container
      document.getElementById('myCanvasContainer').style.display = 'none';
    }
  };
});

  function showModal(id){
  	$('#'+id).modal('show');
  }

  function hideModal(id){
  	$('#'+id).modal('hide');
  }

$("a.popclass").live("mouseover", function(){ 
    $("a.popclass").popover('destroy');
    $(this).popover('show');
});
</script>
<!-- Modal -->
<div class="modal hide fade" id="twitter_modal" style="height:240px;">
  <div class="modal-header">
    <h3>Share your Beancounter page on Twitter</h3>
  </div>
  <div class="modal-body">
    <textarea style="width:510px; height:100px;"></textarea>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" onclick="hideModal('twitter_modal')">Close</a>
    <%#TODO Da sistemare il messaggio%>
    <%= link_to 'Pubblica su Twitter', user_twitter_publish_path(:message => ""), :class => 'btn btn-primary'%>
  </div>
</div>

<div class="modal hide fade" id="facebook_modal" style="height:240px;">
  <div class="modal-header">
    <h3>Share your Beancounter page on Facebook</h3>
  </div>
  <div class="modal-body">
    <textarea style="width:510px; height:100px;"></textarea>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" onclick="hideModal('facebook_modal')">Close</a>
    <%= link_to 'Pubblica su Facebook', user_facebook_publish_path(:message => ""), :class => 'btn btn-primary'%>
  </div>
</div>
<!-- end modal -->

<div class="span15 clearfix" style="margin-bottom:30px;"><h1 style="margin-bottom:10px;">Ciao <%= current_user.name %></h1>
  <% if current_user.provider?("twitter")%>
    <a href="#" role="button" onclick="showModal('twitter_modal')"><%=image_tag "twitter_share.png", :class => "share_image"%></a>
  <% else %>
    ^
    <a href="http://api.beancounter.io/rest/user/oauth/token/twitter/<%=current_user.username%>?redirect=<%=REDIRECT_PATH%>/users" role="button"><%=image_tag "twitter_share.png", :class => "share_image"%></a>
  <% end %>
  <% if current_user.provider?("facebook")%>
    <a href="#" role="button" onclick="showModal('facebook_modal')"><%=image_tag "facebook_share.png", :class => "share_image"%></a>
  <% else %>
    ^
    <a href="http://api.beancounter.io/rest/user/oauth/token/facebook/<%=current_user.username%>?redirect=<%=REDIRECT_PATH%>/users" role="button"><%=image_tag "facebook_share.png", :class => "share_image"%></a>
  <% end %>
</div>

<div class="span15 clearfix" style="margin-bottom:10px;"><h3>Questo Ã¨ il tuo tag interessi:</h3></div>

<div class="span15 clearfix" style="margin-bottom:30px" id="myCanvasContainer">
 <canvas width="1300" height="200" id="myCanvas">
  <p>Anything in here will be replaced on browsers that support the canvas element</p>
  <ul>
    <%@interests.each do |interest|%>
      <li><a href="<%=interest["resource"]%>" data-weight="<%=interest["weight"]*100%>" style="font-size: <%=interest["weight"]*100%>ex"><%= interest["label"] %></a></li>
    <% end %>
  </ul>
 </canvas>
</div>

<div id="customers_table" class="span5 clearfix" style="margin-top:20px">
<table class="table table-striped table-bordered table-condensed">
  <thead>
    <tr> 
      <th>Activity</th>
      <th>Weight</th>
    </tr>
  </thead>
  
  <tbody>                                                                                                                                                                                                  
  <%@interests.each do |interest|%>
    <tr>
      <td><%=interest["label"]%></td>
      <td><%=interest["weight"]*100%></td>
      <td>
        <a href="#" class="popclass btn btn-large btn-danger" rel="popover" data-content='<div style="height:780px"></div>' data-original-title="A Title">Click to toggle popover</a>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>
</div>
